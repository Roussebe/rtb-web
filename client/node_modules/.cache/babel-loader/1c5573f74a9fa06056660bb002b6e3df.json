{"ast":null,"code":"var _jsxFileName = \"/home/roussebe/dev/WakeUpCoach/client/src/components/Rituals/HabitsAddToRitual.js\",\n    _s = $RefreshSig$();\n\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getRituals } from \"../../actions/habit.actions\";\nimport { updateRitualHabits } from \"../../actions/ritual.actions\";\nimport M from 'materialize-css';\nimport { isEmpty } from \"../Utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst HabitSelector = _ref => {\n  let {\n    habit,\n    myClick\n  } = _ref;\n  return /*#__PURE__*/_jsxDEV(\"tr\", {\n    children: [/*#__PURE__*/_jsxDEV(\"td\", {\n      children: habit.title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 9\n    }, this), !habit.selected ? /*#__PURE__*/_jsxDEV(\"td\", {\n      className: \"green-text bold\",\n      onClick: myClick,\n      children: \"Ajouter\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 14,\n      columnNumber: 11\n    }, this) : /*#__PURE__*/_jsxDEV(\"td\", {\n      className: \"red-text bold\",\n      onClick: myClick,\n      children: \"Retirer\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 15,\n      columnNumber: 11\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 12,\n    columnNumber: 5\n  }, this);\n};\n\n_c = HabitSelector;\n\nconst HabitsAddToRitual = _ref2 => {\n  _s();\n\n  let {\n    ritualId\n  } = _ref2;\n  const dispatch = useDispatch();\n  const user = useSelector(state => state.userReducer);\n  const rituals = useSelector(state => state.ritualReducer);\n  const habits = useSelector(state => state.habitReducer);\n  const [userHabitSelection, setUserHabitSelection] = useState([]);\n  useEffect(() => {\n    console.log(\"HabitsAddToRitual useEffect\");\n    /*\n    \n        if( document && document.getElementById('modal-add-habits-to-ritual' ) ) {\n          var modal = document.getElementById('modal-add-habits-to-ritual');\n          var instances = M.Modal.init(modal, {});\n        }*/\n  }, []);\n  useEffect(() => {\n    if (!isEmpty(habits) && !isEmpty(rituals) && ritualId) {\n      const newSelection = habits.map(habit => {\n        return {\n          title: habit.title,\n          selected: rituals.find(ritual => ritual._id == ritualId).habits.find(h => h._id == habit._id) ? true : false,\n          _id: habit._id\n        };\n      });\n      console.log(\"New Selection \", newSelection);\n      setUserHabitSelection(newSelection);\n    }\n  }, [ritualId]);\n\n  function toogleSelection(habit) {\n    let changedHabit = { ...habit,\n      selected: !habit.selected\n    };\n    let newSelection = userHabitSelection.slice();\n    let idx = newSelection.findIndex(h => {\n      return h._id == habit._id;\n    });\n    newSelection[idx] = changedHabit;\n    setUserHabitSelection(newSelection);\n  }\n\n  function saveHabits() {\n    dispatch(updateRitualHabits(ritualId, userHabitSelection));\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"modal-add-habits-to-ritual\",\n    className: \"modal\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-content\",\n      children: /*#__PURE__*/_jsxDEV(\"table\", {\n        id: \"modal1_table\",\n        className: \"striped\",\n        children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: userHabitSelection.map(habit => {\n            return /*#__PURE__*/_jsxDEV(HabitSelector, {\n              habit: habit,\n              myClick: e => {\n                return toogleSelection(habit);\n              }\n            }, habit._id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 78,\n              columnNumber: 18\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 9\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"modal-footer\",\n      children: /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"#!\",\n        className: \"modal-close waves-effect waves-green btn-flat\",\n        onClick: saveHabits,\n        children: \"Confirmer\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n\n_s(HabitsAddToRitual, \"P9W0HeTnkGN11/zNsOvtzrsMmhA=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector];\n});\n\n_c2 = HabitsAddToRitual;\nexport default HabitsAddToRitual;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"HabitSelector\");\n$RefreshReg$(_c2, \"HabitsAddToRitual\");","map":{"version":3,"sources":["/home/roussebe/dev/WakeUpCoach/client/src/components/Rituals/HabitsAddToRitual.js"],"names":["React","useContext","useEffect","useState","useDispatch","useSelector","getRituals","updateRitualHabits","M","isEmpty","HabitSelector","habit","myClick","title","selected","HabitsAddToRitual","ritualId","dispatch","user","state","userReducer","rituals","ritualReducer","habits","habitReducer","userHabitSelection","setUserHabitSelection","console","log","newSelection","map","find","ritual","_id","h","toogleSelection","changedHabit","slice","idx","findIndex","saveHabits","e"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getRituals } from \"../../actions/habit.actions\";\nimport {updateRitualHabits} from \"../../actions/ritual.actions\"\n\nimport M from  'materialize-css';\n\nimport {isEmpty} from \"../Utils\"\n\nconst HabitSelector = ({habit, myClick}) => {\n  return (\n    <tr><td>{habit.title}</td>\n      {!habit.selected\n        ? <td className=\"green-text bold\" onClick={myClick}>Ajouter</td>\n        : <td className=\"red-text bold\" onClick={myClick}>Retirer</td>\n      }\n    </tr>\n  )\n}\n\nconst HabitsAddToRitual = ( {ritualId} ) => {\n  const dispatch = useDispatch();\n\n  const user = useSelector((state) => state.userReducer);\n  const rituals = useSelector((state) => state.ritualReducer);\n  const habits = useSelector((state) => state.habitReducer);\n  const [userHabitSelection, setUserHabitSelection] = useState( [] )\n\n  useEffect( () => {\n    console.log( \"HabitsAddToRitual useEffect\" )\n/*\n\n    if( document && document.getElementById('modal-add-habits-to-ritual' ) ) {\n      var modal = document.getElementById('modal-add-habits-to-ritual');\n      var instances = M.Modal.init(modal, {});\n    }*/\n  }, [])\n\n\n\n  useEffect( () => {\n    if( !isEmpty(habits) && !isEmpty(rituals) && ritualId ) {\n      const newSelection = habits.map( habit => {\n        return {\n          title: habit.title,\n          selected:\n            rituals.find( ritual => ritual._id == ritualId )\n              .habits.find( h => h._id == habit._id )\n            ? true\n            : false\n          ,\n          _id: habit._id\n        }\n      })\n      console.log( \"New Selection \", newSelection )\n      setUserHabitSelection ( newSelection )\n    }\n  },[ritualId])\n\n  function toogleSelection( habit ) {\n    let changedHabit = {...habit, selected: !habit.selected}\n    let newSelection = userHabitSelection.slice()\n    let idx = newSelection.findIndex( (h) => { return h._id == habit._id } )\n    newSelection[idx] = changedHabit\n    setUserHabitSelection( newSelection )\n  }\n\n  function saveHabits() {\n    dispatch(updateRitualHabits(ritualId, userHabitSelection))\n  }\n\n  return (\n    <div id=\"modal-add-habits-to-ritual\" className=\"modal\">\n      <div className=\"modal-content\">\n      <table id=\"modal1_table\" className=\"striped\">\n        <tbody>\n        {userHabitSelection.map( habit => {\n          return <HabitSelector habit={habit} key={habit._id} myClick={(e) => {return toogleSelection(habit)} } />\n        })}\n        </tbody>\n      </table>\n      </div>\n      <div className=\"modal-footer\">\n        <a href=\"#!\" className=\"modal-close waves-effect waves-green btn-flat\" onClick={saveHabits}>Confirmer</a>\n      </div>\n    </div>\n  )\n}\n\nexport default HabitsAddToRitual\n"]},"metadata":{},"sourceType":"module"}