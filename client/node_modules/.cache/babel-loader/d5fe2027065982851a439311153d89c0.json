{"ast":null,"code":"import _asyncToGenerator from\"/home/roussebe/dev/WakeUpCoach/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/roussebe/dev/WakeUpCoach/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/roussebe/dev/WakeUpCoach/client/node_modules/@babel/runtime/regenerator/index.js\";import React,{useEffect,useState}from\"react\";import Routes from\"./components/Routes\";import{UidContext}from\"./components/AppContext\";import axios from\"axios\";import{useDispatch}from\"react-redux\";import{getUser}from\"./actions/user.actions\";import{getHabits}from\"./actions/habit.actions\";import{getRituals}from\"./actions/ritual.actions\";import logger from'redux-logger';import{jsx as _jsx}from\"react/jsx-runtime\";if(!process.env.REACT_APP_API_URL){process.env.REACT_APP_API_URL=\"/\";}var App=function App(){var _useState=useState(null),_useState2=_slicedToArray(_useState,2),uid=_useState2[0],setUid=_useState2[1];var dispatch=useDispatch();useEffect(function(){var fetchToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios({method:\"get\",url:\"\".concat(process.env.REACT_APP_API_URL,\"jwtid\")//withCredentials: true,\n}).then(function(res){console.log(\"Received\",res);setUid(res.data);}).catch(function(err){console.log(\"No token\",err);});case 2:case\"end\":return _context.stop();}}},_callee);}));return function fetchToken(){return _ref.apply(this,arguments);};}();fetchToken();console.log(\"uid\",uid);if(uid){console.log(\"Get the informations\");dispatch(getUser(uid));dispatch(getHabits(20));dispatch(getRituals(20));}},[uid,dispatch]);return/*#__PURE__*/_jsx(UidContext.Provider,{value:uid,children:/*#__PURE__*/_jsx(Routes,{})});};export default App;","map":{"version":3,"sources":["/home/roussebe/dev/WakeUpCoach/client/src/App.js"],"names":["React","useEffect","useState","Routes","UidContext","axios","useDispatch","getUser","getHabits","getRituals","logger","process","env","REACT_APP_API_URL","App","uid","setUid","dispatch","fetchToken","method","url","then","res","console","log","data","catch","err"],"mappings":"oXAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,MAAP,KAAmB,qBAAnB,CACA,OAASC,UAAT,KAA2B,yBAA3B,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,WAAT,KAA4B,aAA5B,CACA,OAASC,OAAT,KAAwB,wBAAxB,CACA,OAASC,SAAT,KAA0B,yBAA1B,CACA,OAASC,UAAT,KAA2B,0BAA3B,CAEA,MAAOC,CAAAA,MAAP,KAAmB,cAAnB,C,2CAEA,GAAI,CAAEC,OAAO,CAACC,GAAR,CAAYC,iBAAlB,CACA,CACEF,OAAO,CAACC,GAAR,CAAYC,iBAAZ,CAAgC,GAAhC,CACD,CAED,GAAMC,CAAAA,GAAG,CAAG,QAANA,CAAAA,GAAM,EAAM,CAChB,cAAsBZ,QAAQ,CAAC,IAAD,CAA9B,wCAAOa,GAAP,eAAYC,MAAZ,eACA,GAAMC,CAAAA,QAAQ,CAAGX,WAAW,EAA5B,CAEAL,SAAS,CAAC,UAAM,CACd,GAAMiB,CAAAA,UAAU,0FAAG,yJACXb,CAAAA,KAAK,CAAC,CACVc,MAAM,CAAE,KADE,CAEVC,GAAG,WAAKT,OAAO,CAACC,GAAR,CAAYC,iBAAjB,SACH;AAHU,CAAD,CAAL,CAKHQ,IALG,CAKE,SAACC,GAAD,CAAS,CACbC,OAAO,CAACC,GAAR,CAAa,UAAb,CAA0BF,GAA1B,EACAN,MAAM,CAACM,GAAG,CAACG,IAAL,CAAN,CACD,CARG,EASHC,KATG,CASG,SAACC,GAAD,CAAS,CACdJ,OAAO,CAACC,GAAR,CAAY,UAAZ,CAAwBG,GAAxB,EACD,CAXG,CADW,uDAAH,kBAAVT,CAAAA,UAAU,0CAAhB,CAeAA,UAAU,GACVK,OAAO,CAACC,GAAR,CAAa,KAAb,CAAoBT,GAApB,EACA,GAAIA,GAAJ,CAAS,CACPQ,OAAO,CAACC,GAAR,CAAa,sBAAb,EACAP,QAAQ,CAACV,OAAO,CAACQ,GAAD,CAAR,CAAR,CACAE,QAAQ,CAACT,SAAS,CAAC,EAAD,CAAV,CAAR,CACAS,QAAQ,CAACR,UAAU,CAAC,EAAD,CAAX,CAAR,CACD,CACF,CAxBQ,CAwBN,CAACM,GAAD,CAAME,QAAN,CAxBM,CAAT,CA0BA,mBACE,KAAC,UAAD,CAAY,QAAZ,EAAqB,KAAK,CAAEF,GAA5B,uBACE,KAAC,MAAD,IADF,EADF,CAOD,CArCD,CAwCA,cAAeD,CAAAA,GAAf","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport Routes from \"./components/Routes\";\nimport { UidContext } from \"./components/AppContext\";\nimport axios from \"axios\";\nimport { useDispatch } from \"react-redux\";\nimport { getUser } from \"./actions/user.actions\";\nimport { getHabits } from \"./actions/habit.actions\";\nimport { getRituals } from \"./actions/ritual.actions\";\n\nimport logger from 'redux-logger'\n\nif( ! process.env.REACT_APP_API_URL )\n{\n  process.env.REACT_APP_API_URL = \"/\"\n}\n\nconst App = () => {\n  const [uid, setUid] = useState(null);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    const fetchToken = async () => {\n      await axios({\n        method: \"get\",\n        url: `${process.env.REACT_APP_API_URL}jwtid`,\n        //withCredentials: true,\n      })\n        .then((res) => {\n          console.log (\"Received\" , res )\n          setUid(res.data);\n        })\n        .catch((err) => {\n          console.log(\"No token\", err);\n        })\n    };\n\n    fetchToken();\n    console.log( \"uid\", uid )\n    if (uid) {\n      console.log( \"Get the informations\" )\n      dispatch(getUser(uid));\n      dispatch(getHabits(20));\n      dispatch(getRituals(20));\n    }\n  }, [uid, dispatch]);\n\n  return (\n    <UidContext.Provider value={uid}>\n      <Routes />\n    </UidContext.Provider>\n  );\n\n\n};\n\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}