{"ast":null,"code":"import _objectSpread from\"/home/roussebe/dev/WakeUpCoach/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/roussebe/dev/WakeUpCoach/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from\"react\";import{useDispatch,useSelector}from\"react-redux\";import{getRituals}from\"../../actions/habit.actions\";import{updateRitualHabits}from\"../../actions/ritual.actions\";import M from'materialize-css';import{isEmpty}from\"../Utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var HabitSelector=function HabitSelector(_ref){var habit=_ref.habit,myClick=_ref.myClick;return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:habit.title}),!habit.selected?/*#__PURE__*/_jsx(\"td\",{className:\"green-text bold\",onClick:myClick,children:\"Ajouter\"}):/*#__PURE__*/_jsx(\"td\",{className:\"red-text bold\",onClick:myClick,children:\"Retirer\"})]});};var HabitsAddToRitual=function HabitsAddToRitual(_ref2){var ritualId=_ref2.ritualId;var dispatch=useDispatch();var user=useSelector(function(state){return state.userReducer;});var rituals=useSelector(function(state){return state.ritualReducer;});var habits=useSelector(function(state){return state.habitReducer;});var _useState=useState([]),_useState2=_slicedToArray(_useState,2),userHabitSelection=_useState2[0],setUserHabitSelection=_useState2[1];useEffect(function(){var modal=document.getElementById('modal-add-habits-to-ritual');var instances=M.Modal.init(modal,{});},[]);useEffect(function(){if(!isEmpty(habits)&&!isEmpty(rituals)&&ritualId){var newSelection=habits.map(function(habit){return{title:habit.title,selected:rituals.find(function(ritual){return ritual._id==ritualId;}).habits.find(function(h){return h._id==habit._id;})?true:false,_id:habit._id};});console.log(\"New Selection \",newSelection);setUserHabitSelection(newSelection);}},[ritualId]);function toogleSelection(habit){var changedHabit=_objectSpread(_objectSpread({},habit),{},{selected:!habit.selected});var newSelection=userHabitSelection.slice();var idx=newSelection.findIndex(function(h){return h._id==habit._id;});newSelection[idx]=changedHabit;setUserHabitSelection(newSelection);}function saveHabits(){dispatch(updateRitualHabits(ritualId,userHabitSelection));}return/*#__PURE__*/_jsxs(\"div\",{id:\"modal-add-habits-to-ritual\",className:\"modal\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"modal-content\",children:/*#__PURE__*/_jsx(\"table\",{id:\"modal1_table\",className:\"striped\",children:/*#__PURE__*/_jsx(\"tbody\",{children:userHabitSelection.map(function(habit){return/*#__PURE__*/_jsx(HabitSelector,{habit:habit,myClick:function myClick(e){return toogleSelection(habit);}},habit._id);})})})}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer\",children:/*#__PURE__*/_jsx(\"a\",{href:\"#!\",className:\"modal-close waves-effect waves-green btn-flat\",onClick:saveHabits,children:\"Confirmer\"})})]});};export default HabitsAddToRitual;","map":{"version":3,"sources":["/home/roussebe/dev/WakeUpCoach/client/src/components/Rituals/HabitsAddToRitual.js"],"names":["React","useContext","useEffect","useState","useDispatch","useSelector","getRituals","updateRitualHabits","M","isEmpty","HabitSelector","habit","myClick","title","selected","HabitsAddToRitual","ritualId","dispatch","user","state","userReducer","rituals","ritualReducer","habits","habitReducer","userHabitSelection","setUserHabitSelection","modal","document","getElementById","instances","Modal","init","newSelection","map","find","ritual","_id","h","console","log","toogleSelection","changedHabit","slice","idx","findIndex","saveHabits","e"],"mappings":"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","sourcesContent":["import React, { useContext, useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getRituals } from \"../../actions/habit.actions\";\nimport {updateRitualHabits} from \"../../actions/ritual.actions\"\n\nimport M from  'materialize-css';\n\nimport {isEmpty} from \"../Utils\"\n\nconst HabitSelector = ({habit, myClick}) => {\n  return (\n    <tr><td>{habit.title}</td>\n      {!habit.selected\n        ? <td className=\"green-text bold\" onClick={myClick}>Ajouter</td>\n        : <td className=\"red-text bold\" onClick={myClick}>Retirer</td>\n      }\n    </tr>\n  )\n}\n\nconst HabitsAddToRitual = ( {ritualId} ) => {\n  const dispatch = useDispatch();\n\n  const user = useSelector((state) => state.userReducer);\n  const rituals = useSelector((state) => state.ritualReducer);\n  const habits = useSelector((state) => state.habitReducer);\n  const [userHabitSelection, setUserHabitSelection] = useState( [] )\n\n  useEffect( () => {\n    var modal = document.getElementById('modal-add-habits-to-ritual');\n    var instances = M.Modal.init(modal, {});\n  }, [])\n\n\n  useEffect( () => {\n    if( !isEmpty(habits) && !isEmpty(rituals) && ritualId ) {\n      const newSelection = habits.map( habit => {\n        return {\n          title: habit.title,\n          selected:\n            rituals.find( ritual => ritual._id == ritualId )\n              .habits.find( h => h._id == habit._id )\n            ? true\n            : false\n          ,\n          _id: habit._id\n        }\n      })\n      console.log( \"New Selection \", newSelection )\n      setUserHabitSelection ( newSelection )\n    }\n  },[ritualId])\n\n  function toogleSelection( habit ) {\n    let changedHabit = {...habit, selected: !habit.selected}\n    let newSelection = userHabitSelection.slice()\n    let idx = newSelection.findIndex( (h) => { return h._id == habit._id } )\n    newSelection[idx] = changedHabit\n    setUserHabitSelection( newSelection )\n  }\n\n  function saveHabits() {\n    dispatch(updateRitualHabits(ritualId, userHabitSelection))\n  }\n\n  return (\n    <div id=\"modal-add-habits-to-ritual\" className=\"modal\">\n      <div className=\"modal-content\">\n      <table id=\"modal1_table\" className=\"striped\">\n        <tbody>\n        {userHabitSelection.map( habit => {\n          return <HabitSelector habit={habit} key={habit._id} myClick={(e) => {return toogleSelection(habit)} } />\n        })}\n        </tbody>\n      </table>\n      </div>\n      <div className=\"modal-footer\">\n        <a href=\"#!\" className=\"modal-close waves-effect waves-green btn-flat\" onClick={saveHabits}>Confirmer</a>\n      </div>\n    </div>\n  )\n}\n\nexport default HabitsAddToRitual\n"]},"metadata":{},"sourceType":"module"}